"use strict";var ue=Object.defineProperty;var le=(n,e,t)=>e in n?ue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>le(n,typeof e!="symbol"?e+"":e,t);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const i=require("./lodash-DlB6Z5__.cjs"),u=require("vue"),ce=require("axios"),he=require("ox/vendor"),d=require("./theme-BS02m0hV.cjs");function de(n){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const t in n)if(t!=="default"){const r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>n[t]})}}return e.default=n,Object.freeze(e)}const fe=de(he);function j(n,e){var t;if(typeof e=="string"){const r=(t=n.use)==null?void 0:t.fields(),s=r&&r[e]||null;e=s instanceof i.Relation?s:null}return e}function W(n){return n instanceof i.HasMany||n instanceof i.HasManyBy||n instanceof i.HasOne||n instanceof i.BelongsTo?n.foreignKey:null}const me=Object.freeze(Object.defineProperty({__proto__:null,ContentType:i.ContentType,Group:i.Group,Meta:i.Meta,Model:i.Model,Permission:i.Permission,Permissions:i.Permissions,User:i.User,asRelation:j,getSourceKey:W},Symbol.toStringTag,{value:"Module"}));class pe{constructor(e,t,r){l(this,"repository");l(this,"config");l(this,"response");l(this,"entities",null);l(this,"isSaved",!1);this.repository=e,this.config=t,this.response=r}async save(){const e=this.getDataFromResponse();if(!this.validateData(e)){console.warn("[Pinia ORM Axios] The response data could not be saved to the store because it is not an object or an array. You might want to use `dataTransformer` option to handle non-array/object response before saving it to the store.");return}let t=this.config.persistBy||"save";this.validatePersistAction(t)||(console.warn('[Pinia ORM Axios] The "persistBy" option configured is not a recognized value. Response data will be persisted by the default `save` method.'),t="save");const r=await this.repository[t](e);this.entities=Array.isArray(r)?r:[r],this.isSaved=!0}async delete(){if(this.config.delete===void 0)throw new Error("[Pinia ORM Axios] Could not delete records because the `delete` option is not set.");await this.repository.query().destroy(this.config.delete)}getDataFromResponse(){return this.config.dataTransformer?this.config.dataTransformer(this.response):this.config.dataKey?this.response.data[this.config.dataKey]:this.response.data}validateData(e){return e!==null&&typeof e=="object"}validatePersistAction(e){return["save","insert"].includes(e)}}class ge{constructor(e){l(this,"repository");l(this,"config",{save:!0});this.repository=e,this.registerActions()}get axios(){if(this.repository.axios=this.repository.axios??this.repository.config.axiosApi.axios,!this.repository.axios)throw new Error("[Pinia ORM Axios] The axios instance is not registered. Please register the axios instance to the repository.");return this.repository.axios}registerActions(){var t,r,s;const e={...(t=this.repository.config.axiosApi)==null?void 0:t.actions,...(s=(r=this.repository.getModel().$config())==null?void 0:r.axiosApi)==null?void 0:s.actions};if(e)for(const o in e){const a=e[o];typeof a=="function"?this.registerFunctionAction(o,a):this.registerObjectAction(o,a)}}registerObjectAction(e,t){this[e]=r=>this.request({...t,...r})}registerFunctionAction(e,t){this[e]=t.bind(this)}get(e,t={}){return this.request({method:"get",url:e,...t})}post(e,t={},r={}){return this.request({method:"post",url:e,data:t,...r})}put(e,t={},r={}){return this.request({method:"put",url:e,data:t,...r})}patch(e,t={},r={}){return this.request({method:"patch",url:e,data:t,...r})}delete(e,t={}){return this.request({method:"delete",url:e,...t})}async request(e){const t=this.createConfig(e),r=await this.axios.request(t);return this.createResponse(r,t)}createConfig(e){return{...this.config,...this.repository.globalApiConfig,...this.repository.apiConfig,...e}}async createResponse(e,t){const r=new pe(this.repository,t,e);return t.delete!==void 0?(await r.delete(),r):(t.save&&await r.save(),r)}}class V extends i.Repository{constructor(t,r){var s,o,a;super(t,r);l(this,"axios");l(this,"globalApiConfig");l(this,"apiConfig");this.axios=((o=(s=i.config)==null?void 0:s.axiosApi)==null?void 0:o.axios)||null,this.globalApiConfig=((a=i.config)==null?void 0:a.axiosApi)||{},this.apiConfig={}}api(){return ye(this)}setAxios(t){return this.axios=t,this}}function ye(n){return new ge(n)}function we(n){const e=i.getActivePinia();return V.useModel=n,i.useRepo(V,e)}function De(n){return i.definePiniaOrmPlugin(e=>(e.config.axiosApi=n,e))}function q(n,{useInject:e=!0,useDefaults:t=!0}={}){var r=e&&(u.inject("repos")||{});const s=e&&!!Object.keys(r).length;Array.isArray(n)||(n=Object.values(n)),t&&n.push(i.User);for(const o of n)if(o&&o.entity){if(o.entity in r)continue;i.useRepo(o),r[o.entity]=we(o)}return!s&&u.provide("repos",r),r}function ve(){return{permissions:[String,Function,Object,Array]}}function U(n,e,t){const r=e instanceof i.Permissions?e:new i.Permissions(e),s=u.computed(()=>r.can(u.unref(n),u.unref(t)));return{permissions:r,allowed:s}}class ${static reactive(e){const t=u.reactive(new this(e));return t.user=u.computed(()=>{var r;return new i.User(((r=t.data)==null?void 0:r.user)||{})}),t}constructor(e={}){Object.assign(this,e),this.state=i.State.none(),this.showState=!1}load(e=void 0){this.dataEl!==void 0&&(e===void 0&&(e=this.readData(this.dataEl)),e.dataEl=this.dataEl,this.data=e),this.models!==void 0&&(this.repos=q(this.models))}readData(e){const t=document.getElementById(e);if(!t)throw"Element {elementId} not found";return t.innerText?JSON.parse(t.innerText):{}}}function be(n,e=!0){const t=$.reactive(n);return e&&t.dataEl&&t.load(),u.provide("context",t),u.provide("user",t.user),t}function Me({props:n,user:e,emits:t=null}){const r=u.ref(!1),{permissions:s,allowed:o}=U(e,n.permissions,n.item);return{processing:r,permissions:s,allowed:o,run:async(...h)=>{if(n.confirm&&!confirm(n.confirm))return;if(!o.value)throw Error("You are not allowed to execute this action");if(r.value=!0,n.href){document.location.href=n.href;return}let c=n.run(e,n.item,...h);return c instanceof Promise&&(c=await c),r.value=!1,t&&t("completed",n.item,...h),c}}}function S(n){const e=n.slice(-2).toUpperCase();switch(!0){case n==="GB-alt-variant":return{firstDay:0,firstWeekSize:4};case n==="001":return{firstDay:1,firstWeekSize:1};case`AG AS BD BR BS BT BW BZ CA CO DM DO ET GT GU HK HN ID IL IN JM JP KE
    KH KR LA MH MM MO MT MX MZ NI NP PA PE PH PK PR PY SA SG SV TH TT TW UM US
    VE VI WS YE ZA ZW`.includes(e):return{firstDay:0,firstWeekSize:1};case`AI AL AM AR AU AZ BA BM BN BY CL CM CN CR CY EC GE HR KG KZ LB LK LV
    MD ME MK MN MY NZ RO RS SI TJ TM TR UA UY UZ VN XK`.includes(e):return{firstDay:1,firstWeekSize:1};case`AD AN AT AX BE BG CH CZ DE DK EE ES FI FJ FO FR GB GF GP GR HU IE IS
    IT LI LT LU MC MQ NL NO PL RE RU SE SK SM VA`.includes(e):return{firstDay:1,firstWeekSize:4};case"AE AF BH DJ DZ EG IQ IR JO KW LY OM QA SD SY".includes(e):return{firstDay:6,firstWeekSize:1};case e==="MV":return{firstDay:5,firstWeekSize:1};case e==="PT":return{firstDay:0,firstWeekSize:4};default:return null}}function Se(n,e,t){var y;const r=[];let s=[];const o=B(n),a=L(n),h=t??((y=S(e))==null?void 0:y.firstDay)??0,c=(o.getDay()-h+7)%7,m=(a.getDay()-h+7)%7;for(let f=0;f<c;f++){const p=new Date(o);p.setDate(p.getDate()-(c-f)),s.push(p)}for(let f=1;f<=a.getDate();f++){const p=new Date(n.getFullYear(),n.getMonth(),f);s.push(p),s.length===7&&(r.push(s),s=[])}for(let f=1;f<7-m;f++){const p=new Date(a);p.setDate(p.getDate()+f),s.push(p)}return s.length>0&&r.push(s),r}function A(n,e,t){var o;const r=t??((o=S(e))==null?void 0:o.firstDay)??0,s=new Date(n);for(;s.getDay()!==r;)s.setDate(s.getDate()-1);return s}function xe(n,e){var s;const t=new Date(n),r=((((s=S(e))==null?void 0:s.firstDay)??0)+6)%7;for(;t.getDay()!==r;)t.setDate(t.getDate()+1);return t}function B(n){return new Date(n.getFullYear(),n.getMonth(),1)}function L(n){return new Date(n.getFullYear(),n.getMonth()+1,0)}function ke(n){const e=n.split("-").map(Number);return new Date(e[0],e[1]-1,e[2])}const Te=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function K(n){if(n==null)return new Date;if(n instanceof Date)return n;if(typeof n=="string"){let e;if(Te.test(n))return ke(n);if(e=Date.parse(n),!isNaN(e))return new Date(e)}return null}const I=new Date(2e3,0,2);function Ae(n,e){var r;const t=e??((r=S(n))==null?void 0:r.firstDay)??0;return d.createRange(7).map(s=>{const o=new Date(I);return o.setDate(I.getDate()+t+s),new Intl.DateTimeFormat(n,{weekday:"narrow"}).format(o)})}function Ee(n,e,t,r){const s=K(n)??new Date,o=r==null?void 0:r[e];if(typeof o=="function")return o(s,e,t);let a={};switch(e){case"fullDate":a={year:"numeric",month:"long",day:"numeric"};break;case"fullDateWithWeekday":a={weekday:"long",year:"numeric",month:"long",day:"numeric"};break;case"normalDate":const h=s.getDate(),c=new Intl.DateTimeFormat(t,{month:"long"}).format(s);return`${h} ${c}`;case"normalDateWithWeekday":a={weekday:"short",day:"numeric",month:"short"};break;case"shortDate":a={month:"short",day:"numeric"};break;case"year":a={year:"numeric"};break;case"month":a={month:"long"};break;case"monthShort":a={month:"short"};break;case"monthAndYear":a={month:"long",year:"numeric"};break;case"monthAndDate":a={month:"long",day:"numeric"};break;case"weekday":a={weekday:"long"};break;case"weekdayShort":a={weekday:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(t).format(s.getDate());case"hours12h":a={hour:"numeric",hour12:!0};break;case"hours24h":a={hour:"numeric",hour12:!1};break;case"minutes":a={minute:"numeric"};break;case"seconds":a={second:"numeric"};break;case"fullTime":a={hour:"numeric",minute:"numeric"};break;case"fullTime12h":a={hour:"numeric",minute:"numeric",hour12:!0};break;case"fullTime24h":a={hour:"numeric",minute:"numeric",hour12:!1};break;case"fullDateTime":a={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};break;case"fullDateTime12h":a={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0};break;case"fullDateTime24h":a={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1};break;case"keyboardDate":a={year:"numeric",month:"2-digit",day:"2-digit"};break;case"keyboardDateTime":return a={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric"},new Intl.DateTimeFormat(t,a).format(s).replace(/, /g," ");case"keyboardDateTime12h":return a={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0},new Intl.DateTimeFormat(t,a).format(s).replace(/, /g," ");case"keyboardDateTime24h":return a={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!1},new Intl.DateTimeFormat(t,a).format(s).replace(/, /g," ");default:a=o??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(t,a).format(s)}function Pe(n,e){const t=n.toJsDate(e),r=t.getFullYear(),s=d.padStart(String(t.getMonth()+1),2,"0"),o=d.padStart(String(t.getDate()),2,"0");return`${r}-${s}-${o}`}function Oe(n){const[e,t,r]=n.split("-").map(Number);return new Date(e,t-1,r)}function Ce(n,e){const t=new Date(n);return t.setMinutes(t.getMinutes()+e),t}function Re(n,e){const t=new Date(n);return t.setHours(t.getHours()+e),t}function k(n,e){const t=new Date(n);return t.setDate(t.getDate()+e),t}function Ve(n,e){const t=new Date(n);return t.setDate(t.getDate()+e*7),t}function Ie(n,e){const t=new Date(n);return t.setDate(1),t.setMonth(t.getMonth()+e),t}function E(n){return n.getFullYear()}function Fe(n){return n.getMonth()}function Ye(n,e,t,r){const s=S(e),o=t??(s==null?void 0:s.firstDay)??0,a=r??(s==null?void 0:s.firstWeekSize)??1;function h(D){const v=new Date(D,0,1);return 7-P(v,A(v,e,o),"days")}let c=E(n);const m=k(A(n,e,o),6);c<E(m)&&h(c+1)>=a&&c++;const y=new Date(c,0,1),f=h(c),p=f>=a?k(y,f-7):k(y,f);return 1+P(n,p,"weeks")}function Ne(n){return n.getDate()}function je(n){return new Date(n.getFullYear(),n.getMonth()+1,1)}function We(n){return new Date(n.getFullYear(),n.getMonth()-1,1)}function qe(n){return n.getHours()}function Ue(n){return n.getMinutes()}function $e(n){return new Date(n.getFullYear(),0,1)}function Be(n){return new Date(n.getFullYear(),11,31)}function Le(n,e){return T(n,e[0])&&ze(n,e[1])}function Ke(n){const e=new Date(n);return e instanceof Date&&!isNaN(e.getTime())}function T(n,e){return n.getTime()>e.getTime()}function He(n,e){return T(O(n),O(e))}function ze(n,e){return n.getTime()<e.getTime()}function F(n,e){return n.getTime()===e.getTime()}function _e(n,e){return n.getDate()===e.getDate()&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()}function Ge(n,e){return n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()}function Ze(n,e){return n.getFullYear()===e.getFullYear()}function P(n,e,t){const r=new Date(n),s=new Date(e);switch(t){case"years":return r.getFullYear()-s.getFullYear();case"quarters":return Math.floor((r.getMonth()-s.getMonth()+(r.getFullYear()-s.getFullYear())*12)/4);case"months":return r.getMonth()-s.getMonth()+(r.getFullYear()-s.getFullYear())*12;case"weeks":return Math.floor((r.getTime()-s.getTime())/(1e3*60*60*24*7));case"days":return Math.floor((r.getTime()-s.getTime())/(1e3*60*60*24));case"hours":return Math.floor((r.getTime()-s.getTime())/(1e3*60*60));case"minutes":return Math.floor((r.getTime()-s.getTime())/(1e3*60));case"seconds":return Math.floor((r.getTime()-s.getTime())/1e3);default:return r.getTime()-s.getTime()}}function Je(n,e){const t=new Date(n);return t.setHours(e),t}function Qe(n,e){const t=new Date(n);return t.setMinutes(e),t}function Xe(n,e){const t=new Date(n);return t.setMonth(e),t}function et(n,e){const t=new Date(n);return t.setDate(e),t}function tt(n,e){const t=new Date(n);return t.setFullYear(e),t}function O(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0)}function nt(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999)}class rt{constructor(e){this.locale=e.locale,this.formats=e.formats}date(e){return K(e)}toJsDate(e){return e}toISO(e){return Pe(this,e)}parseISO(e){return Oe(e)}addMinutes(e,t){return Ce(e,t)}addHours(e,t){return Re(e,t)}addDays(e,t){return k(e,t)}addWeeks(e,t){return Ve(e,t)}addMonths(e,t){return Ie(e,t)}getWeekArray(e,t){const r=t!==void 0?Number(t):void 0;return Se(e,this.locale,r)}startOfWeek(e,t){const r=t!==void 0?Number(t):void 0;return A(e,this.locale,r)}endOfWeek(e){return xe(e,this.locale)}startOfMonth(e){return B(e)}endOfMonth(e){return L(e)}format(e,t){return Ee(e,t,this.locale,this.formats)}isEqual(e,t){return F(e,t)}isValid(e){return Ke(e)}isWithinRange(e,t){return Le(e,t)}isAfter(e,t){return T(e,t)}isAfterDay(e,t){return He(e,t)}isBefore(e,t){return!T(e,t)&&!F(e,t)}isSameDay(e,t){return _e(e,t)}isSameMonth(e,t){return Ge(e,t)}isSameYear(e,t){return Ze(e,t)}setMinutes(e,t){return Qe(e,t)}setHours(e,t){return Je(e,t)}setMonth(e,t){return Xe(e,t)}setDate(e,t){return et(e,t)}setYear(e,t){return tt(e,t)}getDiff(e,t,r){return P(e,t,r)}getWeekdays(e){const t=e!==void 0?Number(e):void 0;return Ae(this.locale,t)}getYear(e){return E(e)}getMonth(e){return Fe(e)}getWeek(e,t,r){const s=t!==void 0?Number(t):void 0;return Ye(e,this.locale,s,r)}getDate(e){return Ne(e)}getNextMonth(e){return je(e)}getPreviousMonth(e){return We(e)}getHours(e){return qe(e)}getMinutes(e){return Ue(e)}startOfDay(e){return O(e)}endOfDay(e){return nt(e)}startOfYear(e){return $e(e)}endOfYear(e){return Be(e)}}const st=Symbol.for("vuetify:date-options"),Y=Symbol.for("vuetify:date-adapter");function it(n,e){const t=d.mergeDeep({adapter:rt,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},n);return{options:t,instance:ot(t,e)}}function ot(n,e){const t=u.reactive(typeof n.adapter=="function"?new n.adapter({locale:n.locale[e.current.value]??e.current.value,formats:n.formats}):n.adapter);return u.watch(e.current,r=>{t.locale=n.locale[r]??r??t.locale}),t}function H(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:e,...t}=n,r=d.mergeDeep(e,t),{aliases:s={},components:o={},directives:a={}}=r,h=u.effectScope();return h.run(()=>{const c=d.createDefaults(r.defaults),m=d.createDisplay(r.display,r.ssr),y=d.createTheme(r.theme),f=d.createIcons(r.icons),p=d.createLocale(r.locale),D=it(r.date,p),v=d.createGoTo(r.goTo,p);function x(g){for(const w in a)g.directive(w,a[w]);for(const w in o)g.component(w,o[w]);for(const w in s)g.component(w,d.defineComponent({...s[w],name:w,aliasName:s[w].name}));const R=u.effectScope();if(R.run(()=>{y.install(g)}),g.onUnmount(()=>R.stop()),g.provide(d.DefaultsSymbol,c),g.provide(d.DisplaySymbol,m),g.provide(d.ThemeSymbol,y),g.provide(d.IconSymbol,f),g.provide(d.LocaleSymbol,p),g.provide(st,D.options),g.provide(Y,D.instance),g.provide(d.GoToSymbol,v),d.IN_BROWSER&&r.ssr)if(g.$nuxt)g.$nuxt.hook("app:suspense:resolve",()=>{m.update()});else{const{mount:w}=g;g.mount=function(){const ae=w(...arguments);return u.nextTick(()=>m.update()),g.mount=w,ae}}g.mixin({computed:{$vuetify(){return u.reactive({defaults:b.call(this,d.DefaultsSymbol),display:b.call(this,d.DisplaySymbol),theme:b.call(this,d.ThemeSymbol),icons:b.call(this,d.IconSymbol),locale:b.call(this,d.LocaleSymbol),date:b.call(this,Y)})}}})}function oe(){h.stop()}return{install:x,unmount:oe,defaults:c,display:m,theme:y,icons:f,locale:p,date:D,goTo:v}})}const at="3.8.4";H.version=at;function b(n){var r,s;const e=this.$,t=((r=e.parent)==null?void 0:r.provides)??((s=e.vnode.appContext)==null?void 0:s.provides);if(t&&n in t)return t[n]}const ut={defaults:{VAppBar:{flat:!0},VAutocomplete:{variant:"outlined"},VBanner:{color:"primary"},VBottomSheet:{contentClass:"rounded-t-xl overflow-hidden"},VBtn:{color:"primary",rounded:"xl"},VBtnGroup:{rounded:"xl",VBtn:{rounded:null}},VCard:{rounded:"lg"},VCheckbox:{color:"secondary",inset:!0},VChip:{rounded:"sm"},VCombobox:{variant:"outlined"},VDateInput:{variant:"outlined"},VDatePicker:{controlHeight:48,color:"primary",divided:!0,headerColor:"",elevation:3,rounded:"xl",VBtn:{color:"high-emphasis",rounded:"circle"}},VFileInput:{variant:"outlined"},VNavigationDrawer:{},VNumberInput:{variant:"outlined",VBtn:{color:void 0,rounded:void 0}},VSelect:{variant:"outlined"},VSlider:{color:"primary"},VTabs:{color:"primary"},VTextarea:{variant:"outlined"},VTextField:{variant:"outlined"},VToolbar:{VBtn:{color:null}}},icons:{defaultSet:"mdi",sets:{mdi:d.mdi}},theme:{themes:{light:{colors:{primary:"#6750a4",secondary:"#b4b0bb",tertiary:"#7d5260",error:"#b3261e",surface:"#fffbfe"}}}}},lt={lighten4:"#c8e6c9",darken1:"#43a047"},N={green:lt};function ct({App:n=null,el:e="#app",onLoad:t=!0,...r}={}){function s(){const o=z(n,r),a=e?o.mount(e):null;return document.body.classList.remove("loading"),{app:o,el:e,vm:a}}return new Promise(o=>{if(t)return window.addEventListener("load",()=>o(s()));o(s())})}function z(n,{props:e={},vuetify:t={},plugins:r=null}={}){return n=u.createApp(n,e),n.config.globalProperties.window=window,n.use(_(t)),n.use(i.i18n),i.useI18n(),r&&r.forEach(s=>n.use(s)),n}function _({components:n={},defaults:e={},...t}){return t.components={...fe,...n},H({blueprint:ut,theme:{themes:{light:{dark:!1,colors:{primary:N.green.darken1,secondary:N.green.lighten4}}}},defaults:{...e,VTextField:{variant:"underlined"},VSelect:{variant:"underlined"},VTextarea:{variant:"outlined"},VCombobox:{variant:"underlined"},VAutocomplete:{variant:"underlined"}},...t})}function ht({axiosConfig:n=null,baseURL:e=null}={}){e||(e=document.body.dataset.apiUrl);const t=i.createPinia(),r=i.createORM({plugins:[De({axios:ce,...n||i.config$1.axiosConfig,baseURL:e})]});return i.setActivePinia(t),t.use(r)}class M{constructor(e,t=null){this.repo=e,this.repos=t}async fetch({url:e,id:t=null,ids:r=null,repo:s=null,lookup:o="id__in",params:a=void 0,relations:h=null,path:c=null,...m}={}){var f,p,D,v,x;if(s??(s=this.repo),(r==null?void 0:r.length)===1&&(t=r[0],r=null),e||(e=(p=(f=s.use)==null?void 0:f.meta)==null?void 0:p.getUrl({path:c,id:t})),t?m.dataKey=null:m.dataKey??(m.dataKey=(x=(v=(D=s.use)==null?void 0:D.config)==null?void 0:v.axiosApi)==null?void 0:x.dataKey),r&&o!==void 0){if(t)throw Error("Both `ids` and `id` are provided while only one of those arguments is accepted.");a={...a||{}},a[o]=[...r]}const y=await s.api().get(e,{...m,params:a});return h&&(y.relations=await this.relations(y.entities,h,{...m,params:{}})),y}async all({nextKey:e="next",limit:t=-1,...r}={}){const s=await this.fetch(r);let o=s.response.data[e];for(;o;){const a=await this.fetch({...r,url:o});if(a.entities&&(s.entities=s.entities!==null?s.entities.concat(a.entities):a.entities),o=a.response.data[e],t>0&&t--,!t)break}return s}async allOnce(e={}){return(e.repo??this.repo).first()?null:await this.all(e)}async relations(e,t,r={}){var a;this._ensureRepos("relations");const s={},o=(a=this.repo.use)==null?void 0:a.fields();if(o)for(const h of t){const c=o[h];if(c instanceof i.Relation)s[h]=await this.relation(e,c,r);else throw Error(`Field ${h} is not a relation`)}return s}_ensureRepos(e){if(!this.repos)throw Error(`Query.repos is not provided although it is mandatory to call ${e}.`)}async relation(e,t,r={}){this._ensureRepos("relations");const s=j(this.repo,t);if(!s)throw Error(`No Relation found for field ${t}.`);const o=s.related.constructor.entity,a=this.repos[o];if(!a)throw Error(`No repository "${o}" found.`);const h=W(s);if(!h)throw Error(`No source ids attributes for ${t}.`);const c=[...new Set(i.collectAttr(e,h))];return new M(a,this.repos).all({...r,ids:c,repo:a})}}function G(n,e){if(typeof n=="string"){if(!(n in e))throw Error(`Repository "${n}" is not present in provided repositories.`);return new M(e[n],e)}return new M(n,e)}class C{constructor(e){l(this,"state",i.State.none());l(this,"value",{});e&&i.assignNonEmpty(this,e),this.state||(this.state=new i.State),this.value??(this.value={}),this.empty??(this.empty={}),this.initial??(this.initial=this.props.initial||this.empty),this.valid=!0,this.reset(this.initial)}get name(){return this.props.name}get url(){return this.props.url}get errors(){return this.state.isError&&this.state.data||null}discard(){this.reset(this.initial)}reset(e=null){i.reset(this.value,e??this.empty),this.state.none()}isEdited(){return!i.lodashExports.isEqual(this.value,this.initial)}async save(e=null,t={}){var s;if(this.state.processing(),this.valid===!1)return this.state.error({_:"Some of the input values are invalid"});e??(e=this.value),e instanceof FormData?t.headers={...i.config$1.axiosConfig.headers,"Content-Type":"multipart/form-data",...t.headers}:e=this.serialize(e);const r=await this.send(e,t);return r.isOk?(this.reset(r.data,!0),(s=this.saved)==null||s.call(this,this.value)):this.state=r,this.state}saved(e){var t,r;(r=(t=this.props).saved)==null||r.call(t,e,this)}serialize(e){return e}send(e,t){throw"not implemented"}}class Z{constructor(e=null){l(this,"index","list.table");l(this,"view","");l(this,"value",null);l(this,"item",null);l(this,"editions",new Set);l(this,"confirmTKey","panel.confirm");e&&i.assignNonEmpty(this,e),this.view??(this.view=this.index||"")}get name(){var e;return((e=this.props)==null?void 0:e.name)||""}get edited(){var e;return!!((e=this.editions)!=null&&e.size)}get icon(){var e;return((e=this.props)==null?void 0:e.icon)||null}get title(){var e;return(e=this.props)==null?void 0:e.title}getUrlParams(){const e={panel:this.name};return this.view!=this.index&&(e.view=this.view),this.view.startsWith("detail.")&&this.value&&(e.value=this.value),e}setEdition(e,t){t?this.editions.add(e):this.editions.delete(e)}show({view:e=null,value:t=null,silent:r=!1,force:s=!1}={}){return(e!=this.view||t!=this.value)&&(s||this.onLeave())?(this.view=e||this.index,this.value=t,!r&&this.updateLocation(),!0):!1}updateLocation(){const e=this.getUrlParams();if(e){const t=new URLSearchParams(e).toString();history.pushState(e,"",`?${t}`)}}onLeave(){if(!this.edited)return!0;const e=i.t(this.confirmTKey);return confirm(e)}onViewChange(e){console.log("onViewChange",e),e||(this.view=this.index)}onValueChange(e){}}class J{constructor(e=null){l(this,"panel","");l(this,"params",{});l(this,"paramsString","");l(this,"children",{});l(this,"current");e&&i.assignNonEmpty(this,e)}readDocumentLocation(){this.paramsString=document.location.search.substring(1);const e=new URLSearchParams(this.paramsString),{panel:t,...r}=Object.fromEntries(e.entries());this.panel=t,this.params=r||{}}static readPath(e){if(!e)return{panel:"",view:""};const t=e.indexOf(".");return t<0?{panel:e,view:""}:{panel:e.substring(0,t),view:e.substring(t+1)}}register(e,t){this.children[e]||(this.children[e]=t,this.panel==t.name&&(this.current=t,t.show(this.params)))}unregister(e){delete this.children[e]}show({force:e=!1,href:t=null,...r}){if(e||!this.current||this.current.onLeave()){if(t&&window.location.pathname!=t){if(!r.panel)throw Error("The attribute `href` requires`panel`.");t=`${t}?panel=${r.panel}`,r.view&&(t=`${t}&view=${r.view||""}`),window.location.href=t;return}this.reset(r)}}reset({panel:e,silent:t=!1,...r}){var o;e&&e!=this.panel&&this.current&&!this.current.onLeave()||(this.panel=e||this.panel,this.params=r,this.current=this.children[this.panel],(o=this.current)==null||o.show({...this.params,silent:t}))}}class Q{constructor(e=null){l(this,"state",i.State.none());l(this,"save",!0);e&&i.assignNonEmpty(this,e)}get repo(){return this.query.repo}get model(){return this.repo.use}queryset(e=null,t=!1){let r=this.repo.query();if(this.relations)for(const s of this.relations)r=r.with(s);return e?r.whereId(e):r}async load(e={}){this.state.processing();let t=null;try{t=await this.fetch(e),t=await this.handleResponse(e,t)}catch(r){this.state.error(r)}return this.state.isError||this.state.none(),t}async fetch(e={}){const t=this.getQueryOptions(e);return await this.query.fetch(t)}async handleResponse(e,t){return t}getQueryOptions(e){return!e.relations&&this.relations&&this.fetchRelations&&(e.relations=this.relations),e.url||(e.url=this.url),"save"in e||(e.save=this.save),e}}class X extends Q{constructor(){super(...arguments);l(this,"items",[]);l(this,"filters",{});l(this,"nextUrl",null);l(this,"prevUrl",null);l(this,"count",null);l(this,"dataKey","results");l(this,"nextKey","next");l(this,"prevKey","previous");l(this,"countKey","count")}get length(){return this.items.length}get ids(){return this.items.map(t=>t.id)}get(t){return t<this.items.length?this.items[t]:null}reset(t=[]){this.items=t,this.nextUrl=null,this.prevUrl=null}findIndex(t){return this.items.findIndex(r=>r.id==t)}contains(t){return this.findIndex(t)!=-1}add(t,r=null){const s=this.findIndex(t.id);return s!=-1?s:r!==null?(this.items.splice(r,1,t),r):(this.items.push(t),this.items.length-1)}getSiblingIndex(t,r){if(t===null)return-1;const s=this.findIndex(t.id),o=s>=0?s+r:-1;return o>=0&&o<this.items.length?o:-1}async loadNext(t){return await this.load({...t,url:this.nextUrl})}async loadPrev(t){return await this.load({...t,url:this.prevUrl})}getQueryOptions(t){return this.filters&&(t.params={...this.filters,...t.params??[]}),super.getQueryOptions(t)}async handleResponse({append:t=!1,...r},s){return s=await super.handleResponse(r,s),this.state.isError||(typeof t=="number"?this.items.splice(t,0,...s.entities):this.items=t?this.items.concat(s.entities):s.entities,this.items=i.lodashExports.uniqWith(this.items,(o,a)=>o.id==a.id),this.nextUrl=s.response.data[this.nextKey]||null,this.prevUrl=s.response.data[this.prevKey]||null,this.count=s.response.data[this.countKey]||this.length),s}}class ee extends C{constructor(e){e.fields=Object.keys(e.props.repo.use.fields()),e.empty??(e.empty=new e.props.repo.use),super(e)}get repo(){return this.props.repo}get name(){return this.props.name||`${this.repo.use.entity}-edit`}isEdited(){return!i.lodashExports.isEqual(i.lodashExports.pick(this.value,this.fields),i.lodashExports.pick(this.initial,this.fields))}get url(){var t,r;const e=super.url||((r=(t=this.repo.use)==null?void 0:t.meta)==null?void 0:r.url);if(!e)throw Error("No url specified as parameter or in Model.meta.");return e}reset(e){(!e||!Object.keys(e).length)&&(e=this.empty);const t=this.fields.filter(r=>r in e);this.value=i.lodashExports.cloneDeep(i.lodashExports.pick(e,t))||{},this.state.none()}serialize(e){const t=this.repo.use;return new t({...this.value}).$toJson(null,{relations:!1})}send(e,t={}){let[r,s]=["post",this.url];return e.id&&(s=`${s}${e.id}/`,r="put"),this.repo.api()[r](s,e,t).then(o=>i.State.ok(o.entities[0]),o=>i.State.error(o.response.data))}}class te extends Z{constructor(t){var r;super(t);l(this,"showFilters",!1);this.showFilters=((r=this.props)==null?void 0:r.showFilters)||!1}get repo(){return this.props.repo}get model(){return this.repo.use}get query(){return this.list.query}get icon(){var t;return super.icon||((t=this.model.meta)==null?void 0:t.icon)}get title(){var o,a,h,c;const{props:t,list:r}=this,s=this.repo.use;if(s){if((o=this.view)!=null&&o.startsWith("list."))return i.t(i.tKeys.model(s),3);if((a=this.view)!=null&&a.startsWith("detail.")){if((h=this.value)!=null&&h.$title)return this.value.$title;const m=i.t(i.tKeys.model(s));return(c=this.value)!=null&&c.id?i.t("models._.title",{model:m,id:this.value.id}):i.t("models._.title.new",{model:m})}}return super.title}getUrlParams(){const{value:t=null,...r}=super.getUrlParams();return t!=null&&t.id&&(r.id=t.id),r}create(t="detail.edit"){this.show({view:t,value:null})}created(t,r="detail.edit"){this.show({view:r,value:t})}show({id:t=null,...r}){if(t)G(this.repo).fetch({id:t,relations:this.relations}).then(s=>(super.show({...r,value:s.entities[0]}),s));else return super.show(r)}onViewChange(t){super.onViewChange(t),t.startsWith("list.")&&this.list.load()}onValueChange(t){}}function dt(n){const e=u.reactive(new J(n));u.provide("panels",e),u.onMounted(()=>{e.readDocumentLocation(),e.panel&&e.show({panel:e.panel,silent:!0,...e.params})}),window.addEventListener("popstate",r=>{r.state&&e.show({...r.state,silent:!0})});const t=document.title;return u.watch(()=>{var r;return(r=e.current)==null?void 0:r.title},r=>{r?document.title=`${r} | ${t}`:document.title=t}),e}function ne(n,e){const t=u.reactive(new e(n));return u.provide("panel",t),u.onMounted(()=>t.panels.register(t.name,t)),u.onUnmounted(()=>t.panels.unregister(t.name)),{panel:t}}function ft({query:n,repos:e,...t}){e??(e=u.inject("repos")),n??(n=se(t.props.repo,u.inject("repos"))),t.panels??(t.panels=u.inject("panels"));const{list:r,items:s}=re({query:n,relations:t.props.relations,fetchRelations:t.props.fetchRelations}),{panel:o}=ne({list:r,...t},te),a=u.computed(()=>{const c=r.getSiblingIndex(u.unref(o.value),1);return s.value[c]??null}),h=u.computed(()=>{const c=r.getSiblingIndex(u.unref(o.value),-1);return s.value[c]??null});return{panels:o.panels,panel:o,list:r,items:s,next:a,prev:h}}function re(n,e=X){const t=u.reactive(new e(n)),r=u.computed(()=>t.save&&t.relations&&t.length?t.queryset(t.ids).orderBy(s=>t.ids.indexOf(s)).get():t.items);return u.provide("list",t),u.provide("items",r),{list:t,items:r}}function se(n,e=null){const t=new M(n,e);return u.provide("query",t),t}function ie(n,e=C){n.initial||n.props.initial;const t=u.reactive(new e(n));u.provide("editor",t);const r=u.computed(()=>t.isEdited());u.watch(()=>t.props.initial,o=>{t.initial=o||t.empty,t.reset(o||t.empty)});const s=u.inject("panel");return s&&u.watch(()=>t.edited,o=>s.setEdition(t.name,o)),{editor:t,edited:r}}function mt(n,e=ee){return ie(n,e)}const pt={required(n){return n?!0:i.t("fields._.required")},errors(n){return()=>n!=null&&n.length?n.join("<br>")||!1:!0},optional(n){return e=>!e||n(e)},email(n){return/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(n)||i.t("fields.email.rule")},username(n){return/^[A-Za-z0-9@.+\-_]+$/.test(n)||"Username must not be empty. It only can contain letters, numbers and @/+/./- special characters"}};function gt(n,e){return u.defineAsyncComponent(()=>import(n).then(t=>e?(console.log(t,t.components,Object.keys(t)),Object.values(t).filter(s=>s.__name==e)[0]):t))}exports.State=i.State;exports.States=i.States;exports.assignNonEmpty=i.assignNonEmpty;exports.collectAttr=i.collectAttr;exports.config=i.config$1;exports.createI18n=i.createI18n;Object.defineProperty(exports,"csrfToken",{enumerable:!0,get:()=>i.csrfToken});exports.excludeValues=i.excludeValues;exports.filterSlots=i.filterSlots;exports.filterValues=i.filterValues;exports.getCookie=i.getCookie;exports.getCookieList=i.getCookieList;exports.getCsrf=i.getCsrf;exports.i18n=i.i18n;exports.injectOrProvide=i.injectOrProvide;exports.loadedLocalePaths=i.loadedLocalePaths;exports.mapToObject=i.mapToObject;exports.reset=i.reset;exports.setLocale=i.setLocale;exports.shallowCopy=i.shallowCopy;exports.splitValues=i.splitValues;exports.t=i.t;exports.tKeys=i.tKeys;exports.useI18n=i.useI18n;exports.AppContext=$;exports.Editor=C;exports.ModelController=Q;exports.ModelEditor=ee;exports.ModelList=X;exports.ModelPanel=te;exports.Panel=Z;exports.Panels=J;exports.Query=M;exports.createApp=z;exports.createPinia=ht;exports.createVuetify=_;exports.defineAsyncComponent=gt;exports.init=ct;exports.models=me;exports.query=G;exports.rules=pt;exports.useAction=Me;exports.useAppContext=be;exports.useEditor=ie;exports.useModelEditor=mt;exports.useModelList=re;exports.useModelPanel=ft;exports.useModels=q;exports.usePanel=ne;exports.usePanels=dt;exports.usePermissions=U;exports.usePermissionsProps=ve;exports.useQuery=se;
//# sourceMappingURL=ox.cjs.map
