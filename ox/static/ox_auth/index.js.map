{"version":3,"file":"index.js","sources":["../../../assets/@ox/auth/src/components/OxGroupEdit.vue","../../../assets/@ox/auth/src/components/OxGroupUsers.vue","../../../assets/@ox/auth/src/components/OxGroupPanel.vue","../../../assets/@ox/auth/src/components/OxAgentSelect.vue","../../../assets/@ox/auth/src/components/OxOwnedPanel.vue","../../../assets/@ox/auth/src/app.js","../../../assets/@ox/auth/src/index.ts"],"sourcesContent":["<template>\n    <ox-model-edit v-bind=\"props\" :repo=\"repos.groups\">\n        <template #default=\"{editor, editable}\">\n            <v-expansion-panels mandatory multiple :model-value=\"['info']\">\n                <v-expansion-panel :title=\"t('views.edit.informations')\" value=\"info\">\n                    <template #text>\n                        <v-text-field variant=\"underlined\" label=\"Group name\"\n                            v-model=\"editor.value.name\"\n                            :rules=\"[rules.errors(editor.errors?.name)]\" />\n                    </template>\n                </v-expansion-panel>\n                <v-expansion-panel :title=\"t('models.permissions', 2)\" value='permissions' v-if=\"editable && editor.value.id && user.can('auth.view_permission')\">\n                    <template #text>\n                        <v-expansion-panel-text>\n                            <ox-permissions-edit :group=\"editor.value\"\n                                v-model=\"editor.value.permissions_id\"/>\n                        </v-expansion-panel-text>\n                    </template>\n                </v-expansion-panel>\n            </v-expansion-panels>\n        </template>\n    </ox-model-edit>\n</template>\n<script setup lang=\"ts\">\nimport {inject} from 'vue'\n\nimport {t, rules} from 'ox'\nimport type {IModelEditorProps} from 'ox'\nimport {OxModelEdit} from 'ox/components'\n\nimport {useAuthModels} from '../composables'\nimport OxPermissionsEdit from './OxPermissionsEdit.vue'\n\nconst repos = useAuthModels()\nconst user = inject('user')\nconst props = defineProps<IModelEditorProps>()\n</script>\n","<template>\n    <v-table>\n        <thead>\n            <tr>\n                <th>{{ t('fields.username') }}</th>\n                <th>{{ t('fields.first_name') }}</th>\n                <th>{{ t('fields.last_name') }}</th>\n                <th>{{ t('fields.actions') }}</th>\n            </tr>\n        </thead>\n        <tbody>\n            <template v-for=\"user in users\">\n                <tr>\n                    <td>{{ user.username }}</td>\n                    <td>{{ user.first_name }}</td>\n                    <td>{{ user.last_name }}</td>\n                    <td>\n                        <ox-action button name=\"edit\" :value=\"user\"/>\n                    </td>\n                </tr>\n            </template>\n        </tbody>\n\n    </v-table>\n</template>\n<script setup>\nimport {computed, inject, defineProps} from 'vue'\n\nimport {t, query} from 'ox'\nimport {OxAction} from 'ox/components'\n\nconst repos = inject('repos')\nconst props = defineProps({\n    group: Object,\n})\n\nconst users = computed(() => repos.users.where('groups_id', (k) => k?.includes(props.group?.id)).get())\n\n</script>\n","<template>\n    <ox-model-panel v-bind=\"props\" :repo=\"repos.groups\" icon=\"mdi-account-multiple\">\n        <template v-for=\"(_, name) in slots\" :key=\"name\" #[name]=\"bind\">\n            <slot :name=\"name\" v-bind=\"bind\"></slot>\n        </template>\n\n        <template #views.detail.edit.default=\"{value, saved}\">\n            <ox-group-edit :initial=\"value\" :saved=\"saved\"/>\n        </template>\n\n        <!--\n        <template #views.detail.edit.tab.users=\"{value}\">\n            <v-tab v-if=\"value?.id\" text=\"Members\" value=\"users\"/>\n        </template>\n        <template #views.detail.edit.window.users=\"{value}\">\n            <ox-group-users :group=\"value\"/>\n        </template> -->\n    </ox-model-panel>\n</template>\n<script setup lang=\"ts\">\nimport { defineProps, useSlots, withDefaults } from 'vue'\n\nimport type {IModelPanelProps} from 'ox'\n\nimport { OxModelPanel } from 'ox/components'\nimport { useAuthModels } from '../composables'\nimport OxGroupEdit from './OxGroupEdit.vue'\n\nconst slots = useSlots()\n\nconst repos = useAuthModels()\nconst props = withDefaults(defineProps<IModelPanelProps>(), {\n    name: 'groups',\n    headers: ['id', 'name'],\n})\n</script>\n","<template>\n    <template v-if=\"props.menu\">\n        <v-menu\n            :aria-label=\"t('fields.agent.select')\"\n            :title=\"t('fields.agent.select')\"\n            v-bind=\"attrs\"\n        >\n            <template #activator=\"{props: $props}\">\n                <v-btn v-bind=\"$props\" :prepend-icon=\"props.icon\" :text=\"item?.name\"  />\n            </template>\n            <v-list :items=\"items\" item-title=\"name\" item-value=\"id\"\n                selectable v-model:selected=\"value\"\n                />\n        </v-menu>\n    </template>\n    <template v-else>\n        <v-select :items=\"items\" item-title=\"name\" item-value=\"id\"\n            :prepend-icon=\"props.icon\"\n            :aria-label=\"t('fields.agent.select')\"\n            :title=\"t('fields.agent.select')\"\n            v-model=\"value\" v-bind=\"attrs\"/>\n    </template>\n</template>\n<script setup lang=\"ts\">\n/**\n * This component displays a v-select box containing available agents\n * for the provided user (if none provided, use `inject(\"user\")` to get\n * current user.\n */\nimport { computed, defineModel, defineExpose, inject, useAttrs, onMounted, ref, watch} from 'vue'\nimport { query, t } from 'ox'\nimport { useAgents } from '../composables'\n\nconst attrs = useAttrs()\nconst props = defineProps({\n    /** Get agents for this user */\n    user: {type: Object, default: null},\n    /** If True, use v-menu instead */\n    menu: Boolean,\n    /** Prepend icon */\n    icon: {type: String, default: \"mdi-account-key\"},\n})\nconst value = defineModel()\nconst repos = useAgents()\nconst items = ref([])\nconst item = ref(null)\n\nvar last = null\n\nconst user = inject('user')\n\nasync function fetch(userId) {\n    if(userId && userId != last) {\n        last = userId\n        const resp = await query(repos.agents).fetch({path: '/user', params: {user: userId}, dataKey: null})\n        items.value = resp.response.data\n        item.value = value.value\n            ? items.value.find((v) => v.id == value.value)\n            : items.value.find((v) => v.user == userId)\n\n        if(value.value != item.value.id)\n            value.value = item.value.id\n    }\n}\n\nonMounted(() => fetch(props.user?.id || user.id))\nwatch(() => props.user, (val) => fetch(val?.id || user.id))\nwatch(value, (val) => {\n    item.value = items.value.find((v) => v.id == val)\n})\n\ndefineExpose({ value, item, items })\n</script>\n","<template>\n    <ox-model-panel v-bind=\"attrs\">\n        <template v-for=\"(_, name) in slots\" :key=\"name\" #[name]=\"bind\">\n            <slot :name=\"name\" v-bind=\"bind\" :owner=\"agent?.item\" v-if=\"name != 'app-bar-right'\"/>\n        </template>\n\n        <template #app-bar-right=\"{panel, list, ...bind}\">\n            <ox-agent-select ref=\"agent\" v-model=\"list.filters.owner__uuid\" :user=\"user\"\n                menu :disabled=\"panel.view.startsWith('detail')\" />\n            <slot name=\"app-bar-right\" :panel=\"panel\" :list=\"list\" :owner=\"agent?.item\" v-bind=\"bind\"/>\n        </template>\n    </ox-model-panel>\n</template>\n<script setup lang=\"ts\">\nimport { useAttrs, ref, inject, useSlots, watch } from 'vue'\nimport {OxModelPanel} from 'ox/components'\nimport OxAgentSelect from './OxAgentSelect'\n\nconst slots = useSlots()\nconst attrs = useAttrs()\nconst user = inject('user')\nconst agent = ref(null)\n</script>\n","import { App } from 'ox/components';\nimport * as components from './components';\nexport default {\n    extends: App,\n    components,\n};\n","import {init, createPinia} from 'ox'\nimport App from './app'\n\nconst pinia = createPinia()\ninit({App, plugins: [pinia] })\n"],"names":["repos","useAuthModels","user","inject","props","__props","_createBlock","_unref","OxModelEdit","_mergeProps","_withCtx","editor","editable","_createVNode","_component_v_expansion_panels","_component_v_expansion_panel","t","_component_v_text_field","$event","_a","_component_v_expansion_panel_text","OxPermissionsEdit","users","computed","k","_component_v_table","_createElementVNode","_createElementBlock","_Fragment","_renderList","_toDisplayString","OxAction","slots","useSlots","OxModelPanel","value","saved","OxGroupEdit","_","name","bind","_renderSlot","_ctx","_normalizeProps","_guardReactiveProps","attrs","useAttrs","_useModel","useAgents","items","ref","item","last","fetch","userId","resp","query","v","onMounted","watch","val","__expose","_openBlock","_component_v_menu","$props","_component_v_btn","_component_v_list","_component_v_select","agent","_createSlots","panel","list","OxAgentSelect","App","components","pinia","createPinia","init"],"mappings":"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"}
