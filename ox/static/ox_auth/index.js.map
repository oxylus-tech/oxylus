{"version":3,"file":"index.js","sources":["../../../assets/@ox/auth/src/components/OxGroupEdit.vue","../../../assets/@ox/auth/src/components/OxGroupUsers.vue","../../../assets/@ox/auth/src/components/OxGroupPanel.vue","../../../assets/@ox/auth/src/components/OxAgentSelect.vue","../../../assets/@ox/auth/src/components/OxOwnedPanel.vue","../../../assets/@ox/auth/src/app.ts","../../../assets/@ox/auth/src/index.ts"],"sourcesContent":["<template>\n    <ox-model-edit v-bind=\"attrs\" :repo=\"repos.groups\">\n        <template #default=\"{editor, editable}\">\n            <v-container>\n                <ox-field :editor=\"editor\" name=\"name\"/>\n            </v-container>\n            <v-expansion-panels mandatory multiple>\n                <v-expansion-panel :title=\"t('models.permission', 2)\" value='permissions' v-if=\"editable && editor.value.id && user.can('auth.view_permission')\">\n                    <template #text>\n                        <v-expansion-panel-text>\n                            <ox-permissions-edit :group=\"editor.value\"\n                                v-model=\"editor.value.permissions\"/>\n                        </v-expansion-panel-text>\n                    </template>\n                </v-expansion-panel>\n            </v-expansion-panels>\n        </template>\n    </ox-model-edit>\n</template>\n<script setup lang=\"ts\">\nimport {inject, useAttrs} from 'vue'\n\nimport {t} from 'ox'\nimport {OxModelEdit, OxField} from 'ox/components'\n\nimport {useAuthModels} from '../composables'\nimport OxPermissionsEdit from './OxPermissionsEdit.vue'\n\nconst repos = useAuthModels()\nconst user = inject('user')\nconst attrs = useAttrs()\n</script>\n","<template>\n    <v-table>\n        <thead>\n            <tr>\n                <th>{{ t('fields.username') }}</th>\n                <th>{{ t('fields.first_name') }}</th>\n                <th>{{ t('fields.last_name') }}</th>\n                <th>{{ t('fields.actions') }}</th>\n            </tr>\n        </thead>\n        <tbody>\n            <template v-for=\"user in users\">\n                <tr>\n                    <td>{{ user.username }}</td>\n                    <td>{{ user.first_name }}</td>\n                    <td>{{ user.last_name }}</td>\n                    <td>\n                        <ox-action button name=\"edit\" :value=\"user\"/>\n                    </td>\n                </tr>\n            </template>\n        </tbody>\n\n    </v-table>\n</template>\n<script setup>\nimport {computed, inject, defineProps} from 'vue'\n\nimport {t, query} from 'ox'\nimport {OxAction} from 'ox/components'\n\nconst repos = inject('repos')\nconst props = defineProps({\n    group: Object,\n})\n\nconst users = computed(() => repos.users.where('groups_id', (k) => k?.includes(props.group?.id)).get())\n\n</script>\n","<template>\n    <ox-model-panel v-bind=\"props\" :repo=\"repos.groups\" icon=\"mdi-account-multiple\">\n        <template v-for=\"(_, name) in slots\" :key=\"name\" #[name]=\"bind\">\n            <slot :name=\"name\" v-bind=\"bind\"></slot>\n        </template>\n\n        <template #views.detail.edit.default=\"{value, saved}\">\n            <ox-group-edit :initial=\"value\" :saved=\"saved\"/>\n        </template>\n\n        <!--\n        <template #views.detail.edit.tab.users=\"{value}\">\n            <v-tab v-if=\"value?.id\" text=\"Members\" value=\"users\"/>\n        </template>\n        <template #views.detail.edit.window.users=\"{value}\">\n            <ox-group-users :group=\"value\"/>\n        </template> -->\n    </ox-model-panel>\n</template>\n<script setup lang=\"ts\">\nimport { defineProps, useSlots, withDefaults } from 'vue'\n\nimport type {IModelPanelProps} from 'ox'\n\nimport { OxModelPanel } from 'ox/components'\nimport { useAuthModels } from '../composables'\nimport OxGroupEdit from './OxGroupEdit.vue'\n\nconst slots = useSlots()\n\nconst repos = useAuthModels()\nconst props = withDefaults(defineProps<IModelPanelProps>(), {\n    name: 'groups',\n    headers: ['id', 'name'],\n})\n</script>\n","<template>\n    <template v-if=\"props.menu\">\n        <v-menu\n            :aria-label=\"t('fields.agent.select')\"\n            :title=\"t('fields.agent.select')\"\n            v-bind=\"attrs\"\n        >\n            <template #activator=\"{props: $props}\">\n                <v-btn v-bind=\"$props\" :prepend-icon=\"props.icon\" :text=\"item?.name\"  />\n            </template>\n            <v-list :items=\"items\" item-title=\"name\" item-value=\"id\"\n                selectable v-model:selected=\"value\"\n                />\n        </v-menu>\n    </template>\n    <template v-else>\n        <v-select :items=\"items\" item-title=\"name\" item-value=\"id\"\n            :prepend-icon=\"props.icon\"\n            :aria-label=\"t('fields.agent.select')\"\n            :title=\"t('fields.agent.select')\"\n            v-model=\"value\" v-bind=\"attrs\"/>\n    </template>\n</template>\n<script setup lang=\"ts\">\n/**\n * This component displays a v-select box containing available agents\n * for the provided user (if none provided, use `inject(\"user\")` to get\n * current user.\n */\nimport { computed, defineModel, defineExpose, inject, useAttrs, onMounted, ref, watch} from 'vue'\nimport { query, t } from 'ox'\nimport { useAgents } from '../composables'\n\nconst attrs = useAttrs()\nconst props = defineProps({\n    /** Get agents for this user */\n    user: {type: Object, default: null},\n    /** If True, use v-menu instead */\n    menu: Boolean,\n    /** Prepend icon */\n    icon: {type: String, default: \"mdi-account-key\"},\n})\nconst value = defineModel()\nconst repos = useAgents()\nconst items = ref([])\nconst item = ref(null)\n\nvar last = null\n\nconst user = inject('user')\n\nasync function fetch(userId) {\n    if(userId && userId != last) {\n        last = userId\n        const resp = await query(repos.agents).fetch({path: '/user', params: {user: userId}, dataKey: null})\n        items.value = resp.response.data\n        item.value = value.value\n            ? items.value.find((v) => v.id == value.value)\n            : items.value.find((v) => v.user == userId)\n\n        if(value.value != item.value.id)\n            value.value = item.value.id\n    }\n}\n\nonMounted(() => fetch(props.user?.id || user.id))\nwatch(() => props.user, (val) => fetch(val?.id || user.id))\nwatch(value, (val) => {\n    item.value = items.value.find((v) => v.id == val)\n})\n\ndefineExpose({ value, item, items })\n</script>\n","<template>\n    <ox-model-panel v-bind=\"attrs\">\n        <template v-for=\"(_, name) in slots\" :key=\"name\" #[name]=\"bind\">\n            <slot :name=\"name\" v-bind=\"bind\" :owner=\"agent?.item\" v-if=\"name != 'app-bar-right'\"/>\n        </template>\n\n        <template #app-bar-right=\"{panel, list, ...bind}\">\n            <ox-agent-select ref=\"agent\" v-model=\"list.filters.owner__uuid\" :user=\"user\"\n                menu :disabled=\"panel.view.startsWith('detail')\" />\n            <slot name=\"app-bar-right\" :panel=\"panel\" :list=\"list\" :owner=\"agent?.item\" v-bind=\"bind\"/>\n        </template>\n    </ox-model-panel>\n</template>\n<script setup lang=\"ts\">\nimport { useAttrs, ref, inject, useSlots, watch } from 'vue'\nimport {OxModelPanel} from 'ox/components'\nimport OxAgentSelect from './OxAgentSelect'\n\nconst slots = useSlots()\nconst attrs = useAttrs()\nconst user = inject('user')\nconst agent = ref(null)\n</script>\n","import {App} from 'ox/components'\nimport * as components from './components'\n\nexport default {\n    extends: App,\n    components,\n}\n","import {init, createPinia} from 'ox'\nimport App from './app'\n\nconst pinia = createPinia()\ninit({App, plugins: [pinia] })\n"],"names":["repos","useAuthModels","user","inject","attrs","useAttrs","_createBlock","_unref","OxModelEdit","_mergeProps","_withCtx","editor","editable","_createVNode","_component_v_container","OxField","_component_v_expansion_panels","_component_v_expansion_panel","t","_component_v_expansion_panel_text","OxPermissionsEdit","$event","props","__props","users","computed","k","_a","_component_v_table","_createElementVNode","_createElementBlock","_Fragment","_renderList","_toDisplayString","OxAction","slots","useSlots","OxModelPanel","value","saved","OxGroupEdit","_","name","bind","_renderSlot","_ctx","_normalizeProps","_guardReactiveProps","_useModel","useAgents","items","ref","item","last","fetch","userId","resp","query","v","onMounted","watch","val","__expose","_openBlock","_component_v_menu","$props","_component_v_btn","_component_v_list","_component_v_select","agent","_createSlots","panel","list","OxAgentSelect","App","components","pinia","createPinia","init"],"mappings":"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"}
