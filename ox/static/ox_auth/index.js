import{t as h,rules as R,query as q,createPinia as D,init as W}from"ox";import{OxModelEdit as H,OxAction as J,OxModelPanel as G,App as K}from"ox/components";import{u as j,O as Q,a as X,_ as Y}from"./OxUserEdit.vue_vue_type_script_setup_true_lang.js";import{_ as Z}from"./OxUserPanel.vue_vue_type_script_setup_true_lang.js";import{defineComponent as y,inject as b,createBlock as V,openBlock as c,unref as l,mergeProps as O,withCtx as u,createVNode as i,createCommentVNode as k,computed as I,createElementVNode as r,toDisplayString as x,createElementBlock as $,Fragment as ee,renderList as U,useSlots as F,createSlots as T,renderSlot as w,normalizeProps as P,guardReactiveProps as C,mergeModels as te,useAttrs as N,useModel as le,ref as A,onMounted as ne,watch as M}from"vue";import{V as se,a as B,b as ae,c as oe,d as ue,e as re,f as ie,g as pe,h as de}from"./vuetify.js";const z=y({__name:"OxGroupEdit",props:{repo:{},initial:{},name:{},url:{},saved:{type:Function}},setup(p){const d=j(),m=b("user"),a=p;return(n,_)=>(c(),V(l(H),O(a,{repo:l(d).groups}),{default:u(({editor:e,editable:t})=>[i(se,{mandatory:"",multiple:"","model-value":["info"]},{default:u(()=>[i(B,{title:l(h)("views.edit.informations"),value:"info"},{text:u(()=>{var o;return[i(ae,{variant:"underlined",label:"Group name",modelValue:e.value.name,"onUpdate:modelValue":g=>e.value.name=g,rules:[l(R).errors((o=e.errors)==null?void 0:o.name)]},null,8,["modelValue","onUpdate:modelValue","rules"])]}),_:2},1032,["title"]),t&&e.value.id&&l(m).can("auth.view_permission")?(c(),V(B,{key:0,title:l(h)("models.permissions",2),value:"permissions"},{text:u(()=>[i(oe,null,{default:u(()=>[i(Q,{group:e.value,modelValue:e.value.permissions_id,"onUpdate:modelValue":o=>e.value.permissions_id=o},null,8,["group","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["title"])):k("",!0)]),_:2},1024)]),_:1},16,["repo"]))}}),me={__name:"OxGroupUsers",props:{group:Object},setup(p){const d=b("repos"),m=p,a=I(()=>d.users.where("groups_id",n=>{var _;return n==null?void 0:n.includes((_=m.group)==null?void 0:_.id)}).get());return(n,_)=>(c(),V(ue,null,{default:u(()=>[r("thead",null,[r("tr",null,[r("th",null,x(l(h)("fields.username")),1),r("th",null,x(l(h)("fields.first_name")),1),r("th",null,x(l(h)("fields.last_name")),1),r("th",null,x(l(h)("fields.actions")),1)])]),r("tbody",null,[(c(!0),$(ee,null,U(a.value,e=>(c(),$("tr",null,[r("td",null,x(e.username),1),r("td",null,x(e.first_name),1),r("td",null,x(e.last_name),1),r("td",null,[i(l(J),{button:"",name:"edit",value:e},null,8,["value"])])]))),256))])]),_:1}))}},ce=y({__name:"OxGroupPanel",props:{repo:{},view:{},headers:{default:["id","name"]},relations:{},showFilters:{type:Boolean},fetchRelations:{type:Boolean},search:{},warning:{},name:{default:"groups"},index:{},value:{},state:{},help:{},title:{},icon:{}},setup(p){const d=F(),m=j(),a=p;return(n,_)=>(c(),V(l(G),O(a,{repo:l(m).groups,icon:"mdi-account-multiple"}),T({"views.detail.edit.default":u(({value:e,saved:t})=>[i(z,{initial:e,saved:t},null,8,["initial","saved"])]),_:2},[U(l(d),(e,t)=>({name:t,fn:u(o=>[w(n.$slots,t,P(C(o)))])}))]),1040,["repo"]))}}),L=y({__name:"OxAgentSelect",props:te({user:{type:Object,default:null},menu:Boolean,icon:{type:String,default:"mdi-account-key"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(p,{expose:d}){const m=N(),a=p,n=le(p,"modelValue"),_=X(),e=A([]),t=A(null);var o=null;const g=b("user");async function E(s){if(s&&s!=o){o=s;const f=await q(_.agents).fetch({path:"/user",params:{user:s}});e.value=f.response.data,t.value=e.value.find(v=>v.user==s),n.value=t.value.id}}return ne(()=>{var s;return E(((s=a.user)==null?void 0:s.id)||g.id)}),M(()=>a.user,s=>E((s==null?void 0:s.id)||g.id)),M(n,s=>{t.value=e.value.find(f=>f.id==s)}),d({value:n,item:t,items:e}),(s,f)=>a.menu?(c(),V(re,{key:0},{activator:u(({props:v})=>{var S;return[i(pe,O(v,{"prepend-icon":a.icon,text:(S=t.value)==null?void 0:S.name}),null,16,["prepend-icon","text"])]}),default:u(()=>[i(ie,{items:e.value,"item-title":"name","item-value":"id",selectable:"",selected:n.value,"onUpdate:selected":f[0]||(f[0]=v=>n.value=v)},null,8,["items","selected"])]),_:1})):(c(),V(de,O({key:1,items:e.value,"item-title":"name","item-value":"id","prepend-icon":a.icon,modelValue:n.value,"onUpdate:modelValue":f[1]||(f[1]=v=>n.value=v)},l(m)),null,16,["items","prepend-icon","modelValue"]))}}),_e=y({__name:"OxOwnedPanel",setup(p){const d=F(),m=N(),a=b("user");return(n,_)=>(c(),V(l(G),P(C(l(m))),T({"app-bar-right":u(({panel:e,list:t,...o})=>[i(l(L),{modelValue:t.filters.owner__uuid,"onUpdate:modelValue":g=>t.filters.owner__uuid=g,user:l(a),menu:"",disabled:e.view.startsWith("detail")},null,8,["modelValue","onUpdate:modelValue","user","disabled"]),w(n.$slots,"app-bar-right",O({panel:e,list:t},o))]),_:2},[U(l(d),(e,t)=>({name:t,fn:u(o=>[t!="app-bar-right"?w(n.$slots,t,P(O({key:0},o))):k("",!0)])}))]),1040))}}),fe=Object.freeze(Object.defineProperty({__proto__:null,OxAgentSelect:L,OxGroupEdit:z,OxGroupPanel:ce,OxGroupUsers:me,OxOwnedPanel:_e,OxUserEdit:Y,OxUserPanel:Z},Symbol.toStringTag,{value:"Module"})),ve={extends:K,components:fe},xe=D();W({App:ve,plugins:[xe]});
//# sourceMappingURL=index.js.map
