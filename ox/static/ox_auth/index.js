import{t as O,rules as R,query as q,createPinia as D,init as W}from"ox";import{OxModelEdit as H,OxAction as J,OxModelPanel as B,App as K}from"ox/components";import{u as G,O as Q,a as X,_ as Y}from"./OxUserEdit.vue_vue_type_script_setup_true_lang.js";import{_ as Z}from"./OxUserPanel.vue_vue_type_script_setup_true_lang.js";import{defineComponent as w,inject as b,createBlock as h,openBlock as _,unref as t,mergeProps as y,withCtx as u,createVNode as p,createCommentVNode as j,computed as I,createElementVNode as r,toDisplayString as g,createElementBlock as $,Fragment as ee,renderList as E,useSlots as k,createSlots as F,renderSlot as P,normalizeProps as T,guardReactiveProps as C,mergeModels as te,useAttrs as N,useModel as ne,ref as U,onMounted as le,watch as A}from"vue";import{V as se,a as M,b as ae,c as oe,d as ue,e as re,f as ie,g as pe,h as de}from"./vuetify.js";const z=w({__name:"OxGroupEdit",props:{repo:{},initial:{},name:{},url:{},saved:{type:Function}},setup(d){const m=G(),c=b("user"),o=d;return(n,i)=>(_(),h(t(H),y(o,{repo:t(m).groups}),{default:u(({editor:e,editable:a})=>[p(se,{mandatory:"",multiple:"","model-value":["info"]},{default:u(()=>[p(M,{title:t(O)("views.edit.informations"),value:"info"},{text:u(()=>{var l;return[p(ae,{variant:"underlined",label:"Group name",modelValue:e.value.name,"onUpdate:modelValue":f=>e.value.name=f,rules:[t(R).errors((l=e.errors)==null?void 0:l.name)]},null,8,["modelValue","onUpdate:modelValue","rules"])]}),_:2},1032,["title"]),a&&e.value.id&&t(c).can("auth.view_permission")?(_(),h(M,{key:0,title:t(O)("models.permissions",2),value:"permissions"},{text:u(()=>[p(oe,null,{default:u(()=>[p(Q,{group:e.value,modelValue:e.value.permissions_id,"onUpdate:modelValue":l=>e.value.permissions_id=l},null,8,["group","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["title"])):j("",!0)]),_:2},1024)]),_:1},16,["repo"]))}}),me={__name:"OxGroupUsers",props:{group:Object},setup(d){const m=b("repos"),c=d,o=I(()=>m.users.where("groups_id",n=>{var i;return n==null?void 0:n.includes((i=c.group)==null?void 0:i.id)}).get());return(n,i)=>(_(),h(ue,null,{default:u(()=>[r("thead",null,[r("tr",null,[r("th",null,g(t(O)("fields.username")),1),r("th",null,g(t(O)("fields.first_name")),1),r("th",null,g(t(O)("fields.last_name")),1),r("th",null,g(t(O)("fields.actions")),1)])]),r("tbody",null,[(_(!0),$(ee,null,E(o.value,e=>(_(),$("tr",null,[r("td",null,g(e.username),1),r("td",null,g(e.first_name),1),r("td",null,g(e.last_name),1),r("td",null,[p(t(J),{button:"",name:"edit",value:e},null,8,["value"])])]))),256))])]),_:1}))}},ce=w({__name:"OxGroupPanel",props:{repo:{},view:{},headers:{default:["id","name"]},relations:{},showFilters:{type:Boolean},fetchRelations:{type:Boolean},search:{},warning:{},name:{default:"groups"},index:{},value:{},state:{},help:{},title:{},icon:{}},setup(d){const m=k(),c=G(),o=d;return(n,i)=>(_(),h(t(B),y(o,{repo:t(c).groups,icon:"mdi-account-multiple"}),F({"views.detail.edit.default":u(({value:e,saved:a})=>[p(z,{initial:e,saved:a},null,8,["initial","saved"])]),_:2},[E(t(m),(e,a)=>({name:a,fn:u(l=>[P(n.$slots,a,T(C(l)))])}))]),1040,["repo"]))}}),L=w({__name:"OxAgentSelect",props:te({user:{type:Object,default:null},menu:Boolean,icon:{type:String,default:"mdi-account-key"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(d,{expose:m}){const c=N(),o=d,n=ne(d,"modelValue"),i=X(),e=U([]),a=U(null);var l=null;const f=b("user");async function v(s){if(s&&s!=l){l=s;const x=await q(i.agents).fetch({path:"/user",params:{user:s}});e.value=x.response.data,a.value=e.value.find(V=>V.user==s),n.value=a.value.id}}return le(()=>{var s;return v(((s=o.user)==null?void 0:s.id)||f.id)}),A(()=>o.user,s=>v((s==null?void 0:s.id)||f.id)),A(n,s=>{a.value=e.value.find(x=>x.id==s)}),m({value:n,item:a,items:e}),(s,x)=>o.menu?(_(),h(re,{key:0},{activator:u(({props:V})=>{var S;return[p(pe,y(V,{"prepend-icon":o.icon,text:(S=a.value)==null?void 0:S.name}),null,16,["prepend-icon","text"])]}),default:u(()=>[p(ie,{items:e.value,"item-title":"name","item-value":"id",selectable:"",selected:n.value,"onUpdate:selected":x[0]||(x[0]=V=>n.value=V)},null,8,["items","selected"])]),_:1})):(_(),h(de,y({key:1,items:e.value,"item-title":"name","item-value":"id","prepend-icon":o.icon,modelValue:n.value,"onUpdate:modelValue":x[1]||(x[1]=V=>n.value=V)},t(c)),null,16,["items","prepend-icon","modelValue"]))}}),_e=w({__name:"OxOwnedPanel",setup(d){const m=k(),c=N(),o=b("user"),n=U(null);return(i,e)=>(_(),h(t(B),T(C(t(c))),F({"app-bar-right":u(({panel:a,list:l,...f})=>{var v;return[p(t(L),{ref_key:"agent",ref:n,modelValue:l.filters.owner__uuid,"onUpdate:modelValue":s=>l.filters.owner__uuid=s,user:t(o),menu:"",disabled:a.view.startsWith("detail")},null,8,["modelValue","onUpdate:modelValue","user","disabled"]),P(i.$slots,"app-bar-right",y({panel:a,list:l,owner:(v=n.value)==null?void 0:v.item},f))]}),_:2},[E(t(m),(a,l)=>({name:l,fn:u(f=>{var v;return[l!="app-bar-right"?P(i.$slots,l,y({key:0},f,{owner:(v=n.value)==null?void 0:v.item})):j("",!0)]})}))]),1040))}}),fe=Object.freeze(Object.defineProperty({__proto__:null,OxAgentSelect:L,OxGroupEdit:z,OxGroupPanel:ce,OxGroupUsers:me,OxOwnedPanel:_e,OxUserEdit:Y,OxUserPanel:Z},Symbol.toStringTag,{value:"Module"})),ve={extends:K,components:fe},xe=D();W({App:ve,plugins:[xe]});
//# sourceMappingURL=index.js.map
