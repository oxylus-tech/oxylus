import{t as _,query as L,createPinia as R,init as q}from"ox";import{OxModelEdit as D,OxField as K,OxAction as W,OxModelPanel as B,App as H}from"ox/components";import{u as G,O as J,a as Q,_ as X}from"./OxUserEdit.vue_vue_type_script_setup_true_lang.js";import{_ as Y}from"./OxUserPanel.vue_vue_type_script_setup_true_lang.js";import{defineComponent as y,inject as w,useAttrs as S,createBlock as O,openBlock as f,unref as e,mergeProps as h,withCtx as u,createVNode as p,createCommentVNode as j,computed as Z,createElementVNode as r,toDisplayString as V,createElementBlock as A,Fragment as I,renderList as U,useSlots as k,createSlots as C,renderSlot as P,normalizeProps as F,guardReactiveProps as N,mergeModels as ee,useModel as te,ref as E,onMounted as le,watch as M}from"vue";import{V as ne,a as ae,b as se,c as oe,d as ue,e as re,f as ie,g as de,h as pe}from"./vuetify.js";const T=y({__name:"OxGroupEdit",setup(v){const c=G(),i=w("user"),o=S();return(t,d)=>(f(),O(e(D),h(e(o),{repo:e(c).groups}),{default:u(({editor:l,editable:n})=>[p(ne,null,{default:u(()=>[p(e(K),{editor:l,name:"name"},null,8,["editor"])]),_:2},1024),p(ae,{mandatory:"",multiple:""},{default:u(()=>[n&&l.value.id&&e(i).can("auth.view_permission")?(f(),O(se,{key:0,title:e(_)("models.permission",2),value:"permissions"},{text:u(()=>[p(oe,null,{default:u(()=>[p(J,{group:l.value,modelValue:l.value.permissions,"onUpdate:modelValue":s=>l.value.permissions=s},null,8,["group","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["title"])):j("",!0)]),_:2},1024)]),_:1},16,["repo"]))}}),ce={__name:"OxGroupUsers",props:{group:Object},setup(v){const c=w("repos"),i=v,o=Z(()=>c.users.where("groups_id",t=>{var d;return t==null?void 0:t.includes((d=i.group)==null?void 0:d.id)}).get());return(t,d)=>(f(),O(ue,null,{default:u(()=>[r("thead",null,[r("tr",null,[r("th",null,V(e(_)("fields.username")),1),r("th",null,V(e(_)("fields.first_name")),1),r("th",null,V(e(_)("fields.last_name")),1),r("th",null,V(e(_)("fields.actions")),1)])]),r("tbody",null,[(f(!0),A(I,null,U(o.value,l=>(f(),A("tr",null,[r("td",null,V(l.username),1),r("td",null,V(l.first_name),1),r("td",null,V(l.last_name),1),r("td",null,[p(e(W),{button:"",name:"edit",value:l},null,8,["value"])])]))),256))])]),_:1}))}},me=y({__name:"OxGroupPanel",props:{repo:{},view:{},headers:{default:["id","name"]},relations:{},showFilters:{type:Boolean},fetchRelations:{type:Boolean},search:{},warning:{},name:{default:"groups"},index:{},value:{},state:{},help:{},title:{},icon:{}},setup(v){const c=k(),i=G(),o=v;return(t,d)=>(f(),O(e(B),h(o,{repo:e(i).groups,icon:"mdi-account-multiple"}),C({"views.detail.edit.default":u(({value:l,saved:n})=>[p(T,{initial:l,saved:n},null,8,["initial","saved"])]),_:2},[U(e(c),(l,n)=>({name:n,fn:u(s=>[P(t.$slots,n,F(N(s)))])}))]),1040,["repo"]))}}),z=y({__name:"OxAgentSelect",props:ee({user:{type:Object,default:null},menu:Boolean,icon:{type:String,default:"mdi-account-key"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(v,{expose:c}){const i=S(),o=v,t=te(v,"modelValue"),d=Q(),l=E([]),n=E(null);var s=null;const b=w("user");async function g(a){if(a&&a!=s){s=a;const x=await L(d.agents).fetch({path:"/user",params:{user:a},dataKey:null});l.value=x.response.data,n.value=t.value?l.value.find(m=>m.id==t.value):l.value.find(m=>m.user==a),t.value!=n.value.id&&(t.value=n.value.id)}}return le(()=>{var a;return g(((a=o.user)==null?void 0:a.id)||b.id)}),M(()=>o.user,a=>g((a==null?void 0:a.id)||b.id)),M(t,a=>{n.value=l.value.find(x=>x.id==a)}),c({value:t,item:n,items:l}),(a,x)=>o.menu?(f(),O(re,h({key:0,"aria-label":e(_)("fields.agent.select"),title:e(_)("fields.agent.select")},e(i)),{activator:u(({props:m})=>{var $;return[p(de,h(m,{"prepend-icon":o.icon,text:($=n.value)==null?void 0:$.name}),null,16,["prepend-icon","text"])]}),default:u(()=>[p(ie,{items:l.value,"item-title":"name","item-value":"id",selectable:"",selected:t.value,"onUpdate:selected":x[0]||(x[0]=m=>t.value=m)},null,8,["items","selected"])]),_:1},16,["aria-label","title"])):(f(),O(pe,h({key:1,items:l.value,"item-title":"name","item-value":"id","prepend-icon":o.icon,"aria-label":e(_)("fields.agent.select"),title:e(_)("fields.agent.select"),modelValue:t.value,"onUpdate:modelValue":x[1]||(x[1]=m=>t.value=m)},e(i)),null,16,["items","prepend-icon","aria-label","title","modelValue"]))}}),_e=y({__name:"OxOwnedPanel",setup(v){const c=k(),i=S(),o=w("user"),t=E(null);return(d,l)=>(f(),O(e(B),F(N(e(i))),C({"app-bar-right":u(({panel:n,list:s,...b})=>{var g;return[p(e(z),{ref_key:"agent",ref:t,modelValue:s.filters.owner__uuid,"onUpdate:modelValue":a=>s.filters.owner__uuid=a,user:e(o),menu:"",disabled:n.view.startsWith("detail")},null,8,["modelValue","onUpdate:modelValue","user","disabled"]),P(d.$slots,"app-bar-right",h({panel:n,list:s,owner:(g=t.value)==null?void 0:g.item},b))]}),_:2},[U(e(c),(n,s)=>({name:s,fn:u(b=>{var g;return[s!="app-bar-right"?P(d.$slots,s,h({key:0},b,{owner:(g=t.value)==null?void 0:g.item})):j("",!0)]})}))]),1040))}}),fe=Object.freeze(Object.defineProperty({__proto__:null,OxAgentSelect:z,OxGroupEdit:T,OxGroupPanel:me,OxGroupUsers:ce,OxOwnedPanel:_e,OxUserEdit:X,OxUserPanel:Y},Symbol.toStringTag,{value:"Module"})),ve={extends:H,components:fe},ge=R();q({App:ve,plugins:[ge]});
//# sourceMappingURL=index.js.map
