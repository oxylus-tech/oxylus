import{useModelEditor as E,createPinia as S,init as U}from"ox";import{OxStateAlert as $,OxValidationBtn as A,OxFieldDetails as G,OxAction as F,OxModelPanel as T,App as j}from"ox/components";import{O as k,u as B,_ as M,a as N}from"./OxUserPanel.vue_vue_type_script_setup_true_lang.js";import{inject as x,toRefs as C,useTemplateRef as R,openBlock as u,createBlock as c,withCtx as a,createVNode as s,unref as e,createElementVNode as l,createCommentVNode as g,computed as z,createElementBlock as w,Fragment as D,renderList as h,toDisplayString as V,defineComponent as L,useSlots as I,createSlots as q,renderSlot as H,normalizeProps as J,guardReactiveProps as K}from"vue";import{V as Q,a as W,b as P,c as X,d as Y,e as Z,f as ee,g as te}from"./vuetify.js";const ne={class:"mb-3"},O={__name:"OxGroupEdit",props:{initial:Object},emits:["saved"],setup(f,{emit:p}){const m=p,_=x("repos"),d=f,{initial:o}=C(d),i=R("form"),b=x("panels"),t=E({name:"group-editor",panels:b,initial:o,emits:m,repo:_.groups});return(v,n)=>(u(),c(Q,null,{default:a(()=>[s(e($),{state:e(t).state},null,8,["state"]),l("div",ne,[e(t).edited?(u(),c(e(A),{key:0,onValidate:n[0]||(n[0]=r=>e(t).save()),onReset:n[1]||(n[1]=r=>e(t).reset()),state:e(t).state,"validate-disabled":!e(i).isValid},null,8,["state","validate-disabled"])):g("",!0)]),s(W,{mandatory:"",multiple:"","model-value":["info"]},{default:a(()=>[s(P,{title:"Information",value:"info"},{text:a(()=>[s(X,{ref_key:"form",ref:i,modelValue:e(t).valid,"onUpdate:modelValue":n[3]||(n[3]=r=>e(t).valid=r)},{default:a(()=>[s(Y,{variant:"underlined",label:"Group name",modelValue:e(t).value.name,"onUpdate:modelValue":n[2]||(n[2]=r=>e(t).value.name=r)},{details:a(()=>{var r;return[s(e(G),{errors:(r=e(t).errors)==null?void 0:r.name},null,8,["errors"])]}),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(t).value.id?(u(),c(P,{key:0,title:"Permissions",value:"permissions"},{text:a(()=>[s(Z,null,{default:a(()=>[s(k,{group:e(t).value,modelValue:e(t).value.permissions_id,"onUpdate:modelValue":n[4]||(n[4]=r=>e(t).value.permissions_id=r)},null,8,["group","modelValue"])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1}))}},y={__name:"OxGroupUsers",props:{group:Object},setup(f){const p=x("repos"),m=f,_=z(()=>p.users.where("groups_id",d=>{var o;return d==null?void 0:d.includes((o=m.group)==null?void 0:o.id)}).get());return(d,o)=>(u(),c(ee,null,{default:a(()=>[o[0]||(o[0]=l("thead",null,[l("tr",null,[l("th",null,"Username"),l("th",null,"First Name"),l("th",null,"Last Name"),l("th",null,"Actions")])],-1)),l("tbody",null,[(u(!0),w(D,null,h(_.value,i=>(u(),w("tr",null,[l("td",null,V(i.username),1),l("td",null,V(i.first_name),1),l("td",null,V(i.last_name),1),l("td",null,[s(e(F),{button:"",name:"edit",value:i},null,8,["value"])])]))),256))])]),_:1}))}},ae=L({__name:"OxGroupPanel",props:{repo:{},search:{},view:{},headers:{default:["id","name"]},relations:{},showFilters:{type:Boolean},name:{default:"groups"},index:{},value:{},state:{},help:{},title:{},icon:{}},setup(f){const p=x("context"),m=I(),{repos:_,models:d}=B(),o=f;return(i,b)=>(u(),c(e(T),{name:o.name,icon:"mdi-account-multiple",repo:e(_).groups,headers:o.headers,relations:o.relations,search:"search"},q({"views.detail.edit.tab.users":a(({value:t})=>[t!=null&&t.id?(u(),c(te,{key:0,text:"Members",value:"users"})):g("",!0)]),"views.detail.edit.window.users":a(({value:t})=>[s(y,{group:t},null,8,["group"])]),_:2},[h(e(m),(t,v)=>({name:v,fn:a(n=>[H(i.$slots,v,J(K(n)))])})),!e(m)["views.detail.add"]&&e(p).user.can("auth.add_group")?{name:"views.detail.add",fn:a(({panel:t,value:v,saved:n})=>[s(O,{initial:v,onSaved:n},null,8,["initial","onSaved"])]),key:"0"}:void 0,e(p).user.can("auth.change_group")?{name:"views.detail.edit.window.default",fn:a(({value:t})=>[s(O,{initial:t},null,8,["initial"])]),key:"1"}:void 0]),1032,["name","repo","headers","relations"]))}}),le=Object.freeze(Object.defineProperty({__proto__:null,OxGroupEdit:O,OxGroupPanel:ae,OxGroupUsers:y,OxUserEdit:M,OxUserPanel:N},Symbol.toStringTag,{value:"Module"})),se={extends:j,components:le},oe=S();U({App:se,plugins:[oe]});
//# sourceMappingURL=index.js.map
